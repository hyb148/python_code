<!DOCTYPE html>
<!-- saved from url=(0063)http://sebastianraschka.com/Articles/2014_pca_step_by_step.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <!--META-->
    <meta charset="utf-8">
	<meta name="description" content="Showing how to implement a Principal Component Analysis (PCA) in Python and explaining it step by step.">
	<meta name="Author" content="Sebastian Raschka">

    <title>Principal Component Analysis step by step</title>

    <!-- JavaScript -->
	<script src="./Principal Component Analysis step by step_files/cb=gapi.loaded_1" async=""></script><script type="text/javascript" async="" src="./Principal Component Analysis step by step_files/ga.js"></script><script id="twitter-wjs" src="./Principal Component Analysis step by step_files/widgets.js"></script><script src="./Principal Component Analysis step by step_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" src="./Principal Component Analysis step by step_files/jquery-latest.js"></script>
	<script type="text/javascript" src="./Principal Component Analysis step by step_files/plusone.js" gapi_processed="true"></script>
	<script type="text/javascript" src="./Principal Component Analysis step by step_files/MathJax.js"></script>

	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="./Principal Component Analysis step by step_files/style.css" media="screen">
	<link rel="stylesheet" type="text/css" href="./Principal Component Analysis step by step_files/article.css" media="screen">
	<link rel="stylesheet" type="text/css" href="./Principal Component Analysis step by step_files/codehilite.css" media="screen">

	<!-- Favicon -->
	<link rel="shortcut icon" href="http://sebastianraschka.com/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="http://sebastianraschka.com/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="http://sebastianraschka.com/favicon-196.png">
	<link rel="icon" type="image/png" sizes="160x160" href="http://sebastianraschka.com/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="http://sebastianraschka.com/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="http://sebastianraschka.com/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="http://sebastianraschka.com/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="http://sebastianraschka.com/favicon-16.png">
	<link rel="apple-touch-icon" sizes="152x152" href="http://sebastianraschka.com/favicon-152.png">
	<link rel="apple-touch-icon" sizes="144x144" href="http://sebastianraschka.com/favicon-144.png">
	<link rel="apple-touch-icon" sizes="120x120" href="http://sebastianraschka.com/favicon-120.png">
	<link rel="apple-touch-icon" sizes="114x114" href="http://sebastianraschka.com/favicon-114.png">
	<link rel="apple-touch-icon" sizes="76x76" href="http://sebastianraschka.com/favicon-76.png">
	<link rel="apple-touch-icon" sizes="72x72" href="http://sebastianraschka.com/favicon-72.png">
	<link rel="apple-touch-icon" href="http://sebastianraschka.com/favicon-57.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/favicon-144.png">
	<meta name="msapplication-config" content="/browserconfig.xml">


<script type="text/javascript" async="" src="./Principal Component Analysis step by step_files/embed.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
.en-markup-crop-options {
    top: 18px !important;
    left: 50% !important;
    margin-left: -100px !important;
    width: 200px !important;
    border: 2px rgba(255,255,255,.38) solid !important;
    border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
    margin-left: 0px !important;
}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.5.1') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.5.1') format('opentype')}
</style></head>

<body data-twttr-rendered="true" data-feedly-mini="yes"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<!-- Main Navigation Bar START -->

<div id="header">
	
    <ul>
        <li><a href="http://sebastianraschka.com/articles.html" id="active">blog</a></li>
        <li><a href="http://sebastianraschka.com/webapps.html">webapps</a></li>
        <li><a href="http://sebastianraschka.com/projects.html">projects</a></li>
	    <li><a href="http://sebastianraschka.com/publications.html">books</a></li>
    <li><a href="http://sebastianraschka.com/talks.html">talks</a></li>
	    <li><a href="http://sebastianraschka.com/contact.html">about+contact</a></li>
    </ul>
</div>

<!-- Main Navigation Bar END -->

    <!-- Article Header -->
<article>
<div id="main_article">


	    <h1 class="with_subtitle">Implementing a Principal Component Analysis (PCA) in Python step by step</h1>
		<div class="author_date"><em>-- written by Sebastian Raschka</em> on April 13, 2014</div>

	<!-- Twitter Button -->

  		 <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" src="./Principal Component Analysis step by step_files/tweet_button.46489b28ee1023601b810a443ee8af43.en.html" class="twitter-share-button twitter-tweet-button twitter-share-button twitter-count-horizontal" title="Twitter Tweet Button" data-twttr-rendered="true" style="width: 107px; height: 20px;"></iframe>

   		<script>!function(d,s,id){var
        		js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}
                (document,"script","twitter-wjs");</script>

   	<!-- Google+ -->

        <div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px; background: transparent;"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1429813429739" name="I0_1429813429739" src="./Principal Component Analysis step by step_files/fastbutton.html" data-gapiattached="true" title="+1"></iframe></div><br>


    <!-- Article -->


<p id="abstract">In this article I want to explain how a Principal Component Analysis (PCA) works by implementing it in Python step by step. At the end we will compare the results
to the more convenient Python <code>PCA()</code>classes that are available through the popular <code>matplotlib</code> and <code>scipy</code> libraries and discuss how they differ.
</p>



<p>
<br>
<a id="Sections"></a>

</p><h1 style="padding-top:70px">Sections</h1>

<ul>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#introduction">Introduction</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sample_data">Generating 3-dimensional sample data</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#gen_data">The step by step approach</a>

<ul>
<li>1.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#drop_labels">Taking the whole dataset ignoring the class labels</a></li>
<li>2.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#mean_vec"> Compute the <em>d</em>-dimensional mean vector</a></li>
<li>3.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sc_matrix">Computing the scatter matrix (alternatively, the covariance matrix)</a></li>
<li>4.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#eig_vec">Computing eigenvectors and corresponding eigenvalues</a></li>
<li>5.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sort_eig">Ranking and choosing <em>k</em> eigenvectors</a></li>
<li>6.&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#transform">Transforming the samples onto the new subspace</a></li>
</ul>
</li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#mat_pca">Using the <code>PCA()</code> class from the <code>matplotlib.mlab</code> library</a>

<ul>
<li>&nbsp;<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#diff_mat_pca">Differences between the step by step approach and matplotlib.mlab.PCA()</a></li>
</ul>
</li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sklearn_pca">Using the <code>PCA()</code> class from the sklearn.decomposition library to confirm our results</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#appendix-a">Appendix A: The effect of scaling and mean centering of variables prior to a Principal Component Analysis</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#appendix-b">Appendix B: PCA based on the covariance matrix vs. correlation matrix</a></li>
</ul>

<p><a id="introduction"></a></p>

<h1 style="padding-top:70px">Introduction</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>The main purposes of a principal component analysis are the analysis of data to identify patterns and finding patterns to reduce the dimensions of the dataset with minimal loss of information.</p>

<p>Here, our desired outcome of the principal component analysis is to project a feature space (our dataset consisting of <em>n</em> x <em>d</em>-dimensional samples) onto a smaller subspace that represents our data "well". A possible application would be a pattern classification task, where we want to reduce the computational costs and the error of parameter estimation by reducing the number of dimensions of our feature space by extracting a subspace that describes our data "best".</p>

<hr>


<p><strong>About the notation:</strong><br>
In the following sections, we will use a bold-face and lower-case letters for denoting column vectors (e.g., <strong>e</strong>) and bold-face upper-case letters for matrices (e.g., <strong>W</strong>)</p>

<hr>


<h3 style="padding-top:50px">Principal Component Analysis (PCA) Vs. Multiple Discriminant Analysis (MDA)</h3>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Both Multiple Discriminant Analysis (MDA) and Principal Component Analysis (PCA) are linear transformation methods and closely related to each other. In PCA, we are interested to find the directions (components) that maximize the variance in our dataset, where in MDA, we are additionally interested to find the directions that maximize the separation (or discrimination) between different classes (for example, in pattern classification problems where our dataset consists of multiple classes. In contrast two PCA, which ignores the class labels).<br>
<strong><em>In other words, via PCA, we are projecting the entire set of data (without class labels) onto a different subspace, and in MDA, we are trying to determine a suitable subspace to distinguish between patterns that belong to different classes. Or, roughly speaking in PCA we are trying to find the axes with maximum variances where the data is most spread (within a class, since PCA treats the whole data set as one class), and in MDA we are additionally maximizing the spread between classes. </em></strong><br>
In typical pattern recognition problems, a PCA is often followed by an MDA.</p>

<h4 style="padding-top:40px">What is a "good" subspace?</h4>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Let's assume that our goal is to reduce the dimensions of a <em>d</em>-dimensional dataset by projecting it onto a <em>k</em>-dimensional subspace (where <em>k &lt; d</em>).
So, how do we know what size we should choose for <em>k</em>, and how do we know if we have a feature space that represents our data "well"?<br>
Later, we will compute eigenvectors (the components) from our data set and collect them in a so-called scatter-matrix (or alternatively calculate them from the covariance matrix). Each of those eigenvectors is associated with an eigenvalue, which tell us about the "length" or "magnitude" of the eigenvectors. If we observe that all the eigenvalues are of very similar magnitude, this is a good indicator that our data is already in a "good" subspace. Or if some of the eigenvalues are much much higher than others, we might be interested in keeping only those eigenvectors with the much larger eigenvalues, since they contain more information about our data distribution. Vice versa, eigenvalues that are close to 0 are less informative and we might consider in dropping those when we construct the new feature subspace.</p>




<h3 style="padding-top:50px">Summarizing the PCA approach</h3>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Listed below are the 6 general steps for performing a principal component analysis, which we will investigate in the following sections.</p>

<ol>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#drop_labels"> Take the whole dataset consisting of <em>d</em>-dimensional samples ignoring the class labels</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#mean_vec"> Compute the <em>d</em>-dimensional mean vector</a> (i.e., the means for every dimension of the whole dataset)</li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sc_matrix">Compute the scatter matrix (alternatively, the covariance matrix) of the whole data set</a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#eig_vec">Compute eigenvectors and corresponding eigenvalues </a></li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#sort_eig">Sort the eigenvectors by decreasing eigenvalues and choose <em>k</em> eigenvectors with the largest eigenvalues to form a <em>d</em> x <em>k</em>  dimensional matrix <strong>W</strong></a>  (where every column represents an eigenvector)</li>
<li><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#transform">Use this <em>d</em> x <em>k</em> eigenvector matrix to transform the samples onto the new subspace.</a> This can be summarized by the mathematical equation:<br>
<img src="./Principal Component Analysis step by step_files/pca_equ_1.png"><br>
(where <strong>x</strong> is a <em>d</em> x 1 -dimensional vector representing one sample, and <em>y</em> is the transformed <strong>k</strong> x 1 -dimensional sample in the new subspace.)</li>
</ol>


<p><a id="sample_data"></a></p>

<h1 style="padding-top:70px">Generating some 3-dimensional sample data</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>For the following example, we will generate 40x3-dimensional samples randomly drawn from a multivariate Gaussian distribution.  <br>
Here, we will assume that the samples stem from two different classes, where one half (i.e., 20) samples of our data set are labeled ω1 (class 1) and the other half ω2 (class 2).<br>
<img src="./Principal Component Analysis step by step_files/pca_equ_2.png"></p>

<h3 style="padding-top:50px">Why are we chosing a 3-dimensional sample?</h3>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>The problem of multi-dimensional data is its visualization, which would make it quite tough to follow our example principal component analysis (at least visually). We could also choose a 2-dimensional sample data set for the following examples, but since the goal of the PCA in an "Diminsionality Reduction" application is to drop at least one of the dimensions, I find it more intuitive and visually appealing to start with a 3-dimensional dataset that we reduce to an 2-dimensional dataset by dropping 1 dimension.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span>

np<span style="color: #333333">.</span>random<span style="color: #333333">.</span>seed(<span style="color: #0000DD; font-weight: bold">234234782384239784</span>) <span style="color: #888888"># random seed for consistency</span>

<span style="color: #888888"># A reader pointed out that Python 2.7 would raise a</span>
<span style="color: #888888"># "ValueError: object of too small depth for desired array".</span>
<span style="color: #888888"># This can be avoided by choosing a smaller random seed, e.g. 1</span>
<span style="color: #888888"># or by completely omitting this line, since I just used the random seed for</span>
<span style="color: #888888"># consistency.</span>

mu_vec1 <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array([<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>])
cov_mat1 <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array([[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>],[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>],[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">1</span>]])
class1_sample <span style="color: #333333">=</span> np<span style="color: #333333">.</span>random<span style="color: #333333">.</span>multivariate_normal(mu_vec1, cov_mat1, <span style="color: #0000DD; font-weight: bold">20</span>)<span style="color: #333333">.</span>T
<span style="color: #008800; font-weight: bold">assert</span> class1_sample<span style="color: #333333">.</span>shape <span style="color: #333333">==</span> (<span style="color: #0000DD; font-weight: bold">3</span>,<span style="color: #0000DD; font-weight: bold">20</span>), <span style="background-color: #fff0f0">"The matrix has not the dimensions 3x20"</span>

mu_vec2 <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array([<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">1</span>])
cov_mat2 <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array([[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>],[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>],[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">1</span>]])
class2_sample <span style="color: #333333">=</span> np<span style="color: #333333">.</span>random<span style="color: #333333">.</span>multivariate_normal(mu_vec2, cov_mat2, <span style="color: #0000DD; font-weight: bold">20</span>)<span style="color: #333333">.</span>T
<span style="color: #008800; font-weight: bold">assert</span> class1_sample<span style="color: #333333">.</span>shape <span style="color: #333333">==</span> (<span style="color: #0000DD; font-weight: bold">3</span>,<span style="color: #0000DD; font-weight: bold">20</span>), <span style="background-color: #fff0f0">"The matrix has not the dimensions 3x20"</span>
</pre></div>


<p>Using the code above, we created two 3x20-datasets - one dataset for each class ω1 and ω2 -<br>
where each column can be pictured as a 3-dimensional vector<br>
<img src="./Principal Component Analysis step by step_files/pca_equ_3.png"><br>
so that our dataset will have the form <br>
<img src="./Principal Component Analysis step by step_files/pca_equ_4.png"></p>

<p>Just to get a rough idea how the samples of our two classes ω1 and ω2 are distributed, let us plot them in a 3D scatter plot.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">matplotlib</span> <span style="color: #008800; font-weight: bold">import</span> pyplot <span style="color: #008800; font-weight: bold">as</span> plt
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #008800; font-weight: bold">import</span> Axes3D
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #008800; font-weight: bold">import</span> proj3d

fig <span style="color: #333333">=</span> plt<span style="color: #333333">.</span>figure(figsize<span style="color: #333333">=</span>(<span style="color: #0000DD; font-weight: bold">8</span>,<span style="color: #0000DD; font-weight: bold">8</span>))
ax <span style="color: #333333">=</span> fig<span style="color: #333333">.</span>add_subplot(<span style="color: #0000DD; font-weight: bold">111</span>, projection<span style="color: #333333">=</span><span style="background-color: #fff0f0">'3d'</span>)
plt<span style="color: #333333">.</span>rcParams[<span style="background-color: #fff0f0">'legend.fontsize'</span>] <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">10</span>
ax<span style="color: #333333">.</span>plot(class1_sample[<span style="color: #0000DD; font-weight: bold">0</span>,:], class1_sample[<span style="color: #0000DD; font-weight: bold">1</span>,:],\
    class1_sample[<span style="color: #0000DD; font-weight: bold">2</span>,:], <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">8</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
ax<span style="color: #333333">.</span>plot(class2_sample[<span style="color: #0000DD; font-weight: bold">0</span>,:], class2_sample[<span style="color: #0000DD; font-weight: bold">1</span>,:],\
    class2_sample[<span style="color: #0000DD; font-weight: bold">2</span>,:], <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">8</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)

plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Samples for class 1 and class 2'</span>)
ax<span style="color: #333333">.</span>legend(loc<span style="color: #333333">=</span><span style="background-color: #fff0f0">'upper right'</span>)
plt<span style="color: #333333">.</span>show()
</pre></div>


<p><img src="./Principal Component Analysis step by step_files/pca_plot_1.png"></p>

<p><a id="drop_labels"></a></p>

<h1 style="padding-top:70px">1. Taking the whole dataset ignoring the class labels</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Because we don't need class labels for the PCA analysis, let us merge the samples for our 2 classes into one 3x40-dimensional array.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">all_samples <span style="color: #333333">=</span> np<span style="color: #333333">.</span>concatenate((class1_sample, class2_sample), axis<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">1</span>)
<span style="color: #008800; font-weight: bold">assert</span> all_samples<span style="color: #333333">.</span>shape <span style="color: #333333">==</span> (<span style="color: #0000DD; font-weight: bold">3</span>,<span style="color: #0000DD; font-weight: bold">40</span>), <span style="background-color: #fff0f0">"The matrix has not the dimensions 3x40"</span>
</pre></div>


<p><a id="mean_vec"></a></p>

<h1 style="padding-top:70px">2. Computing the d-dimensional mean vector</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">mean_x <span style="color: #333333">=</span> np<span style="color: #333333">.</span>mean(all_samples[<span style="color: #0000DD; font-weight: bold">0</span>,:])
mean_y <span style="color: #333333">=</span> np<span style="color: #333333">.</span>mean(all_samples[<span style="color: #0000DD; font-weight: bold">1</span>,:])
mean_z <span style="color: #333333">=</span> np<span style="color: #333333">.</span>mean(all_samples[<span style="color: #0000DD; font-weight: bold">2</span>,:])

mean_vector <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array([[mean_x],[mean_y],[mean_z]])

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">'Mean Vector:</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">'</span>, mean_vector)


&gt;&gt; Mean Vector:
 [[ <span style="color: #6600EE; font-weight: bold">0.50576644</span>]
 [ <span style="color: #6600EE; font-weight: bold">0.30186591</span>]
 [ <span style="color: #6600EE; font-weight: bold">0.76459177</span>]]
</pre></div>


<p><a id="mean_vec"></a></p>

<h1 style="padding-top:70px">3. a) Computing the Scatter Matrix</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p><img src="./Principal Component Analysis step by step_files/pca_equ_5.png"></p>

<div class="codehilite"><pre><span class="n">scatter_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">scatter_matrix</span> <span class="o">+=</span> <span class="p">(</span><span class="n">all_samples</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>\
        <span class="o">-</span> <span class="n">mean_vector</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">all_samples</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean_vector</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Scatter Matrix:</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">scatter_matrix</span><span class="p">)</span>


<span class="o">&gt;&gt;</span> <span class="n">Scatter</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">48.91593255</span>   <span class="mf">7.11744916</span>   <span class="mf">7.20810281</span><span class="p">]</span>
<span class="p">[</span>  <span class="mf">7.11744916</span>  <span class="mf">37.92902984</span>   <span class="mf">2.7370493</span> <span class="p">]</span>
<span class="p">[</span>  <span class="mf">7.20810281</span>   <span class="mf">2.7370493</span>   <span class="mf">35.6363759</span> <span class="p">]]</span>
</pre></div>

<p><a id="sc_matrix"></a></p>

<h1 style="padding-top:70px">3. b) Computing the Covariance Matrix (alternatively to the scatter matrix)</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Alternatively, instead of calculating the scatter matrix, we could also calculate the covariance matrix using the in-built <code>numpy.cov()</code> function.  The equations for the covariance matrix and scatter matrix are very similar, the only difference is, that we use the scaling factor
<img src="./Principal Component Analysis step by step_files/pca_equ_6.png">
for the covariance matrix. Thus, their <strong><em>eigenspaces</em></strong> will be identical (identical eigenvectors, only the eigenvalues are scaled differently by a constant factor).</p>

<p><img src="./Principal Component Analysis step by step_files/pca_equ_7.png"></p>

<div class="codehilite"><pre><span class="n">cov_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">([</span><span class="n">all_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">all_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">all_samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]])</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Covariance Matrix:</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">cov_mat</span><span class="p">)</span>


<span class="o">&gt;&gt;</span> <span class="n">Covariance</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">1.25425468</span>  <span class="mf">0.1824987</span>   <span class="mf">0.18482315</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.1824987</span>   <span class="mf">0.97253923</span>  <span class="mf">0.07018075</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.18482315</span>  <span class="mf">0.07018075</span>  <span class="mf">0.91375323</span><span class="p">]]</span>
</pre></div>

<p><a id="eig_vec"></a></p>

<h1 style="padding-top:70px">4. Computing eigenvectors and corresponding eigenvalues</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>To show that the eigenvectors are indeed identical whether we derived them from the scatter or the covariance matrix, let us put an <code>assert</code> statement into the code. Also, we will see that the eigenvalues were indeed scaled by the factor 39 when we derived it from the scatter matrix.</p>

<div class="codehilite"><pre><span class="c"># eigenvectors and eigenvalues for the from the scatter matrix</span>
<span class="n">eig_val_sc</span><span class="p">,</span> <span class="n">eig_vec_sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">scatter_matrix</span><span class="p">)</span>

<span class="c"># eigenvectors and eigenvalues for the from the covariance matrix</span>
<span class="n">eig_val_cov</span><span class="p">,</span> <span class="n">eig_vec_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov_mat</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eig_val_sc</span><span class="p">)):</span>
    <span class="n">eigvec_sc</span> <span class="o">=</span> <span class="n">eig_vec_sc</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">eigvec_cov</span> <span class="o">=</span> <span class="n">eig_vec_cov</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="k">assert</span> <span class="n">eigvec_sc</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="o">==</span> <span class="n">eigvec_cov</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s">'Eigenvectors are not identical'</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'Eigenvector {}: </span><span class="se">\n</span><span class="s">{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">eigvec_sc</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Eigenvalue {} from scatter matrix: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig_val_sc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Eigenvalue {} from covariance matrix: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig_val_cov</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Scaling factor: '</span><span class="p">,</span> <span class="n">eig_val_sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">eig_val_cov</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="mi">40</span> <span class="o">*</span> <span class="s">'-'</span><span class="p">)</span>



<span class="o">&gt;&gt;</span> <span class="n">Eigenvector</span> <span class="mi">1</span><span class="p">:</span>
<span class="p">[[</span><span class="o">-</span><span class="mf">0.84190486</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.39978877</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.36244329</span><span class="p">]]</span>
<span class="n">Eigenvalue</span> <span class="mi">1</span> <span class="kn">from</span> <span class="nn">scatter</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">55.398855957302445</span>
<span class="n">Eigenvalue</span> <span class="mi">1</span> <span class="kn">from</span> <span class="nn">covariance</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">1.4204834860846791</span>
<span class="n">Scaling</span> <span class="n">factor</span><span class="p">:</span>  <span class="mf">39.0</span>
<span class="o">----------------------------------------</span>
<span class="n">Eigenvector</span> <span class="mi">2</span><span class="p">:</span>
<span class="p">[[</span><span class="o">-</span><span class="mf">0.44565232</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.13637858</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.88475697</span><span class="p">]]</span>
<span class="n">Eigenvalue</span> <span class="mi">2</span> <span class="kn">from</span> <span class="nn">scatter</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">32.42754801292286</span>
<span class="n">Eigenvalue</span> <span class="mi">2</span> <span class="kn">from</span> <span class="nn">covariance</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">0.8314755900749456</span>
<span class="n">Scaling</span> <span class="n">factor</span><span class="p">:</span>  <span class="mf">39.0</span>
<span class="o">----------------------------------------</span>
<span class="n">Eigenvector</span> <span class="mi">3</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.30428639</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.90640489</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.29298458</span><span class="p">]]</span>
<span class="n">Eigenvalue</span> <span class="mi">3</span> <span class="kn">from</span> <span class="nn">scatter</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">34.65493432806495</span>
<span class="n">Eigenvalue</span> <span class="mi">3</span> <span class="kn">from</span> <span class="nn">covariance</span> <span class="nn">matrix</span><span class="p">:</span> <span class="mf">0.8885880596939733</span>
<span class="n">Scaling</span> <span class="n">factor</span><span class="p">:</span>  <span class="mf">39.0</span>
<span class="o">----------------------------------------</span>
</pre></div>



<p></p>

<h3 style="padding-top:50px">Checking the eigenvector-eigenvalue calculation</h3>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Let us quickly check that the eigenvector-eigenvalue calculation is correct and satisfy the equation
<img src="./Principal Component Analysis step by step_files/pca_equ_8.png"></p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #007020">len</span>(eig_val_sc)):
    eigv <span style="color: #333333">=</span> eig_vec_sc[:,i]<span style="color: #333333">.</span>reshape(<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">3</span>)<span style="color: #333333">.</span>T
    np<span style="color: #333333">.</span>testing<span style="color: #333333">.</span>assert_array_almost_equal(scatter_matrix<span style="color: #333333">.</span>dot(eigv),\
            eig_val_sc[i] <span style="color: #333333">*</span> eigv, decimal<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">6</span>,\
            err_msg<span style="color: #333333">=</span><span style="background-color: #fff0f0">''</span>, verbose<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)
</pre></div>


<p></p>

<h3 style="padding-top:50px">Visualizing the eigenvectors</h3>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>And before we move on to the next step, just to satisfy our own curiosity, we plot the eigenvectors centered at the sample mean.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">matplotlib</span> <span style="color: #008800; font-weight: bold">import</span> pyplot <span style="color: #008800; font-weight: bold">as</span> plt
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #008800; font-weight: bold">import</span> Axes3D
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #008800; font-weight: bold">import</span> proj3d
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.patches</span> <span style="color: #008800; font-weight: bold">import</span> FancyArrowPatch


<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Arrow3D</span>(FancyArrowPatch):
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">__init__</span>(<span style="color: #007020">self</span>, xs, ys, zs, <span style="color: #333333">*</span>args, <span style="color: #333333">**</span>kwargs):
        FancyArrowPatch<span style="color: #333333">.</span>__init__(<span style="color: #007020">self</span>, (<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>), (<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>), <span style="color: #333333">*</span>args, <span style="color: #333333">**</span>kwargs)
        <span style="color: #007020">self</span><span style="color: #333333">.</span>_verts3d <span style="color: #333333">=</span> xs, ys, zs

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">draw</span>(<span style="color: #007020">self</span>, renderer):
        xs3d, ys3d, zs3d <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_verts3d
        xs, ys, zs <span style="color: #333333">=</span> proj3d<span style="color: #333333">.</span>proj_transform(xs3d, ys3d, zs3d, renderer<span style="color: #333333">.</span>M)
        <span style="color: #007020">self</span><span style="color: #333333">.</span>set_positions((xs[<span style="color: #0000DD; font-weight: bold">0</span>],ys[<span style="color: #0000DD; font-weight: bold">0</span>]),(xs[<span style="color: #0000DD; font-weight: bold">1</span>],ys[<span style="color: #0000DD; font-weight: bold">1</span>]))
        FancyArrowPatch<span style="color: #333333">.</span>draw(<span style="color: #007020">self</span>, renderer)

fig <span style="color: #333333">=</span> plt<span style="color: #333333">.</span>figure(figsize<span style="color: #333333">=</span>(<span style="color: #0000DD; font-weight: bold">7</span>,<span style="color: #0000DD; font-weight: bold">7</span>))
ax <span style="color: #333333">=</span> fig<span style="color: #333333">.</span>add_subplot(<span style="color: #0000DD; font-weight: bold">111</span>, projection<span style="color: #333333">=</span><span style="background-color: #fff0f0">'3d'</span>)

ax<span style="color: #333333">.</span>plot(all_samples[<span style="color: #0000DD; font-weight: bold">0</span>,:], all_samples[<span style="color: #0000DD; font-weight: bold">1</span>,:],\
    all_samples[<span style="color: #0000DD; font-weight: bold">2</span>,:], <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">8</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'green'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.2</span>)
ax<span style="color: #333333">.</span>plot([mean_x], [mean_y], [mean_z], <span style="background-color: #fff0f0">'o'</span>, \
    markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">10</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>)
<span style="color: #008800; font-weight: bold">for</span> v <span style="color: #000000; font-weight: bold">in</span> eig_vec_sc<span style="color: #333333">.</span>T:
    a <span style="color: #333333">=</span> Arrow3D([mean_x, v[<span style="color: #0000DD; font-weight: bold">0</span>]], [mean_y, v[<span style="color: #0000DD; font-weight: bold">1</span>]],\
        [mean_z, v[<span style="color: #0000DD; font-weight: bold">2</span>]], mutation_scale<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">20</span>, lw<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">3</span>, arrowstyle<span style="color: #333333">=</span><span style="background-color: #fff0f0">"-|&gt;"</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">"r"</span>)
    ax<span style="color: #333333">.</span>add_artist(a)
ax<span style="color: #333333">.</span>set_xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
ax<span style="color: #333333">.</span>set_ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
ax<span style="color: #333333">.</span>set_zlabel(<span style="background-color: #fff0f0">'z_values'</span>)

plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Eigenvectors'</span>)

plt<span style="color: #333333">.</span>show()
</pre></div>


<p></p>

<p><img src="./Principal Component Analysis step by step_files/pca_plot_2.png"></p>

<p><a id="sort_eig"></a></p>

<h1 style="padding-top:70px">5.1. Sorting the eigenvectors by decreasing eigenvalues</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>We started with the goal to reduce the dimensionality of our feature space, i.e., projecting the feature space via PCA onto a smaller subspace, where the eigenvectors will form the axes of this new feature subspace. However, the eigenvectors only define the directions of the new axis, since they have all the same unit length 1, which we can confirm by the following code:</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">for</span> ev <span style="color: #000000; font-weight: bold">in</span> eig_vec_sc:
    np<span style="color: #333333">.</span>testing<span style="color: #333333">.</span>assert_array_almost_equal(<span style="color: #6600EE; font-weight: bold">1.0</span>, np<span style="color: #333333">.</span>linalg<span style="color: #333333">.</span>norm(ev))
    <span style="color: #888888"># instead of 'assert' because of rounding errors</span>
</pre></div>


<p>So, in order to decide which eigenvector(s) we want to drop for our lower-dimensional subspace, we have to take a look at the corresponding eigenvalues of the eigenvectors. Roughly speaking, the eigenvectors with the lowest eigenvalues bear the least information about the distribution of the data, and those are the ones we want to drop.<br>
The common approach is to rank the eigenvectors from highest to lowest corresponding eigenvalue and choose the top <em>k</em> eigenvectors.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888"># Make a list of (eigenvalue, eigenvector) tuples</span>
eig_pairs <span style="color: #333333">=</span> [(np<span style="color: #333333">.</span>abs(eig_val_sc[i]), eig_vec_sc[:,i]) <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #007020">len</span>(eig_val_sc))]

<span style="color: #888888"># Sort the (eigenvalue, eigenvector) tuples from high to low</span>
eig_pairs<span style="color: #333333">.</span>sort()
eig_pairs<span style="color: #333333">.</span>reverse()

<span style="color: #888888"># Visually confirm that the list is correctly sorted by decreasing eigenvalues</span>
<span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> eig_pairs:
    <span style="color: #007020">print</span>(i[<span style="color: #0000DD; font-weight: bold">0</span>])

&gt;&gt;
<span style="color: #6600EE; font-weight: bold">55.3988559573</span>
<span style="color: #6600EE; font-weight: bold">34.6549343281</span>
<span style="color: #6600EE; font-weight: bold">32.4275480129</span>
</pre></div>


<p></p>

<h1 style="padding-top:70px">5.2. Choosing <em>k</em> eigenvectors with the largest eigenvalues</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>For our simple example, where we are reducing a 3-dimensional feature space to a 2-dimensional feature subspace, we are combining the two eigenvectors with the highest eigenvalues to construct our <em>d</em> x <em>k</em>-dimensional eigenvector matrix <strong>W</strong>.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">matrix_w <span style="color: #333333">=</span> np<span style="color: #333333">.</span>hstack((eig_pairs[<span style="color: #0000DD; font-weight: bold">0</span>][<span style="color: #0000DD; font-weight: bold">1</span>]<span style="color: #333333">.</span>reshape(<span style="color: #0000DD; font-weight: bold">3</span>,<span style="color: #0000DD; font-weight: bold">1</span>), eig_pairs[<span style="color: #0000DD; font-weight: bold">1</span>][<span style="color: #0000DD; font-weight: bold">1</span>]<span style="color: #333333">.</span>reshape(<span style="color: #0000DD; font-weight: bold">3</span>,<span style="color: #0000DD; font-weight: bold">1</span>)))
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">'Matrix W:</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">'</span>, matrix_w)


&gt;&gt; Matrix W:
 [[<span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.84190486</span>  <span style="color: #6600EE; font-weight: bold">0.30428639</span>]
 [<span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.39978877</span> <span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.90640489</span>]
 [<span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.36244329</span>  <span style="color: #6600EE; font-weight: bold">0.29298458</span>]]
</pre></div>


<p></p>

<p><a id="transform"></a></p>

<h1 style="padding-top:70px">6. Transforming the samples onto the new subspace</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>In the last step, we use the 2x3-dimensional matrix <strong>W</strong> that we just computed to transform our samples onto the new subspace via the equation<br>
<img src="./Principal Component Analysis step by step_files/pca_equ_9.png"></p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">transformed <span style="color: #333333">=</span> matrix_w<span style="color: #333333">.</span>T<span style="color: #333333">.</span>dot(all_samples)
<span style="color: #008800; font-weight: bold">assert</span> transformed<span style="color: #333333">.</span>shape <span style="color: #333333">==</span> (<span style="color: #0000DD; font-weight: bold">2</span>,<span style="color: #0000DD; font-weight: bold">40</span>), <span style="background-color: #fff0f0">"The matrix is not 2x40 dimensional."</span>


plt<span style="color: #333333">.</span>plot(transformed[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>], transformed[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>],\
     <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
plt<span style="color: #333333">.</span>plot(transformed[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>], transformed[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>],
     <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)
plt<span style="color: #333333">.</span>xlim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>ylim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
plt<span style="color: #333333">.</span>ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
plt<span style="color: #333333">.</span>legend()
plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Transformed samples with class labels'</span>)

plt<span style="color: #333333">.</span>show()
</pre></div>


<p><img src="./Principal Component Analysis step by step_files/pca_plot_3.png"></p>

<p><a id="mat_pca"></a></p>

<h1 style="padding-top:70px">Using the PCA() class from the matplotlib.mlab library</h1>

<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>Now, that we have seen how a principal component analysis works, we can use the in-built <code>PCA()</code> class from the <code>matplotlib</code> library for our convenience in future applications.
Unfortunately, the original documentation (<a href="http://matplotlib.sourceforge.net/api/mlab_api.html#matplotlib.mlab.PCA">http://matplotlib.sourceforge.net/api/mlab_api.html#matplotlib.mlab.PCA</a>) is very sparse;<br>
a better documentation can be found here: <a href="https://www.clear.rice.edu/comp130/12spring/pca/pca_docs.shtml">https://www.clear.rice.edu/comp130/12spring/pca/pca_docs.shtml</a>.</p>

<p>And the original code implementation of the <code>PCA()</code> class can be viewed at:<br>
<a href="https://sourcegraph.com/github.com/matplotlib/matplotlib/symbols/python/lib/matplotlib/mlab/PCA">https://sourcegraph.com/github.com/matplotlib/matplotlib/symbols/python/lib/matplotlib/mlab/PCA</a></p>

<h4 style="padding-top:40px">Class attributes of <code>PCA()</code></h4>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">a : a centered unit sigma version of <span style="color: #007020">input</span> a

numrows, numcols: the dimensions of a

mu : a numdims array of means of a

sigma : a numdims array of atandard deviation of a

fracs : the proportion of variance of each of the principal components

Wt : the weight vector <span style="color: #008800; font-weight: bold">for</span> projecting a numdims point <span style="color: #000000; font-weight: bold">or</span> array into PCA space

Y : a projected into PCA space
</pre></div>

<p>Also, it has to be mentioned that the <code>PCA()</code> class expects a <code>np.array()</code> as input where: <code>'we assume data in a is organized with numrows&gt;numcols')</code>, so that we have to transpose our dataset.</p>

<p><code>matplotlib.mlab.PCA()</code> keeps all $d$-dimensions of the input dataset after the transformation (stored in the class attribute <code>PCA.Y</code>), and assuming that they are already ordered ("Since the PCA analysis orders the PC axes by descending importance in terms of describing the clustering, we see that fracs is a list of monotonically decreasing values.", <a href="https://www.clear.rice.edu/comp130/12spring/pca/pca_docs.shtml">https://www.clear.rice.edu/comp130/12spring/pca/pca_docs.shtml</a>) we just need to plot the first 2 columns if we are interested in projecting our 3-dimensional input dataset onto a 2-dimensional subspace.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.mlab</span> <span style="color: #008800; font-weight: bold">import</span> PCA <span style="color: #008800; font-weight: bold">as</span> mlabPCA

mlab_pca <span style="color: #333333">=</span> mlabPCA(all_samples<span style="color: #333333">.</span>T)

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">'PC axes in terms of the measurement axes'</span>\
        <span style="background-color: #fff0f0">' scaled by the standard deviations:</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">'</span>,\
          mlab_pca<span style="color: #333333">.</span>Wt)

plt<span style="color: #333333">.</span>plot(mlab_pca<span style="color: #333333">.</span>Y[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">0</span>],mlab_pca<span style="color: #333333">.</span>Y[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">1</span>], <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>,\
        color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
plt<span style="color: #333333">.</span>plot(mlab_pca<span style="color: #333333">.</span>Y[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">0</span>], mlab_pca<span style="color: #333333">.</span>Y[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">1</span>], <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>,\
        color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)

plt<span style="color: #333333">.</span>xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
plt<span style="color: #333333">.</span>ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
plt<span style="color: #333333">.</span>xlim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>ylim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>legend()
plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Transformed samples with class labels from matplotlib.mlab.PCA()'</span>)

plt<span style="color: #333333">.</span>show()




&gt;&gt; PC axes <span style="color: #000000; font-weight: bold">in</span> terms of the measurement axes scaled by the standard deviations:
 [[ <span style="color: #6600EE; font-weight: bold">0.65043619</span>  <span style="color: #6600EE; font-weight: bold">0.53023618</span>  <span style="color: #6600EE; font-weight: bold">0.54385876</span>]
 [<span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.01692055</span>  <span style="color: #6600EE; font-weight: bold">0.72595458</span> <span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.68753447</span>]
 [ <span style="color: #6600EE; font-weight: bold">0.75937241</span> <span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.43799491</span> <span style="color: #333333">-</span><span style="color: #6600EE; font-weight: bold">0.48115902</span>]]
</pre></div>



<p><img src="./Principal Component Analysis step by step_files/pca_plot_4.png"></p>

<p><a id="diff_mat_pca"></a></p>

<h2 style="padding-top:60px">Differences between the step by step approach and matplotlib.mlab.PCA()</h2>
<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>


<p>When we plot the transformed dataset onto the new 2-dimensional subspace, we observe that the scatter plots from our step by step approach and the <code>matplotlib.mlab.PCA()</code> class do not look identical. This is due to the fact that <code>matplotlib.mlab.PCA()</code> class <strong><em>scales the variables to unit variance</em></strong> prior to calculating the covariance matrices. This will/could eventually lead to different variances along the axes and affect the contribution of the variable to principal components.</p>

<p>One example where a scaling would make sense would be if one variable was measured in the unit <strong>inches</strong> where the other variable was measured in <strong>cm</strong>.<br>
However, for our hypothetical example, we assume that both variables have the same (arbitrary) unit, so that we skipped the step of scaling the input data.</p>

<p><a id="sklearn_pca"> </a></p>

<h1 style="padding-top:70px">Using the PCA() class from the sklearn.decomposition library to confirm our results</h1>
<div class="back_to_top">[<a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>In order to make sure that we have not made a mistake in our step by step approach, we will use another library that doesn't rescale the input data by default.<br>
Here, we will use the PCA class from the <code>scikit-learn</code> machine-learning library. The documentation can be found here:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html</a>.</p>

<p>For our convenience, we can directly specify to how many components we want to reduce our input dataset via the <code>n_components</code> parameter.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">n_components : <span style="color: #007020">int</span>, <span style="color: #008800; font-weight: bold">None</span> <span style="color: #000000; font-weight: bold">or</span> string

Number of components to keep<span style="color: #333333">.</span> <span style="color: #008800; font-weight: bold">if</span> n_components <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #007020">set</span> <span style="color: #007020">all</span> components are kept:
    n_components <span style="color: #333333">==</span> <span style="color: #007020">min</span>(n_samples, n_features)
    <span style="color: #008800; font-weight: bold">if</span> n_components <span style="color: #333333">==</span> <span style="background-color: #fff0f0">'mle'</span>, Minka<span style="background-color: #fff0f0">'s MLE is used to guess the dimension </span>
    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #333333">&lt;=</span> n_components <span style="color: #333333">&lt;=</span> <span style="color: #0000DD; font-weight: bold">1</span>,
    select the number of components such that the amount of variance that needs
    to be explained
    <span style="color: #000000; font-weight: bold">is</span> greater than the percentage specified by n_components
</pre></div>


<p>Next, we just need to use the <code>.fit_transform()</code> in order to perform the dimensionality reduction.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">sklearn.decomposition</span> <span style="color: #008800; font-weight: bold">import</span> PCA <span style="color: #008800; font-weight: bold">as</span> sklearnPCA

sklearn_pca <span style="color: #333333">=</span> sklearnPCA(n_components<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">2</span>)
sklearn_transf <span style="color: #333333">=</span> sklearn_pca<span style="color: #333333">.</span>fit_transform(all_samples<span style="color: #333333">.</span>T)

plt<span style="color: #333333">.</span>plot(sklearn_transf[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">0</span>],sklearn_transf[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">1</span>],\
     <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
plt<span style="color: #333333">.</span>plot(sklearn_transf[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">0</span>], sklearn_transf[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">1</span>],\
     <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)

plt<span style="color: #333333">.</span>xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
plt<span style="color: #333333">.</span>ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
plt<span style="color: #333333">.</span>xlim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>ylim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>legend()
plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Transformed samples with class labels from matplotlib.mlab.PCA()'</span>)

plt<span style="color: #333333">.</span>show()
</pre></div>


<p></p>

<p><img src="./Principal Component Analysis step by step_files/pca_plot_5.png"></p>

<p>The plot above seems to be the exact mirror image of the plot from out step by step approach. This is due to the fact that the signs of the eigenvectors can be either positive or negative, since the eigenvectors are scaled to the unit length 1, both we can simply multiply the transformed data by (-1) revert the mirror image.</p>

<div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">sklearn_transf <span style="color: #333333">=</span> sklearn_transf <span style="color: #333333">*</span> (<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>)

<span style="color: #888888"># sklearn.decomposition.PCA</span>
plt<span style="color: #333333">.</span>plot(sklearn_transf[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">0</span>],sklearn_transf[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>,<span style="color: #0000DD; font-weight: bold">1</span>],\
    <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
plt<span style="color: #333333">.</span>plot(sklearn_transf[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">0</span>], sklearn_transf[<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>,<span style="color: #0000DD; font-weight: bold">1</span>],\
    <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)
plt<span style="color: #333333">.</span>xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
plt<span style="color: #333333">.</span>ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
plt<span style="color: #333333">.</span>xlim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>ylim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>legend()
plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Transformed samples via sklearn.decomposition.PCA'</span>)
plt<span style="color: #333333">.</span>show()

<span style="color: #888888"># step by step PCA</span>
plt<span style="color: #333333">.</span>plot(transformed[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>], transformed[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">20</span>],\
    <span style="background-color: #fff0f0">'o'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'blue'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class1'</span>)
plt<span style="color: #333333">.</span>plot(transformed[<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>], transformed[<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">20</span>:<span style="color: #0000DD; font-weight: bold">40</span>],\
    <span style="background-color: #fff0f0">'^'</span>, markersize<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">7</span>, color<span style="color: #333333">=</span><span style="background-color: #fff0f0">'red'</span>, alpha<span style="color: #333333">=</span><span style="color: #6600EE; font-weight: bold">0.5</span>, label<span style="color: #333333">=</span><span style="background-color: #fff0f0">'class2'</span>)
plt<span style="color: #333333">.</span>xlim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>ylim([<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">4</span>,<span style="color: #0000DD; font-weight: bold">4</span>])
plt<span style="color: #333333">.</span>xlabel(<span style="background-color: #fff0f0">'x_values'</span>)
plt<span style="color: #333333">.</span>ylabel(<span style="background-color: #fff0f0">'y_values'</span>)
plt<span style="color: #333333">.</span>legend()
plt<span style="color: #333333">.</span>title(<span style="background-color: #fff0f0">'Transformed samples step by step approach'</span>)
plt<span style="color: #333333">.</span>show()
</pre></div>


<p><img src="./Principal Component Analysis step by step_files/pca_plot_6.png">
<img src="./Principal Component Analysis step by step_files/pca_plot_7.png"></p>

<p>Looking at the 2 plots above, the distributions along the component axes look identical, only the center of the data is slightly different.</p>

		&nbsp;<br>
     	  &nbsp;<br>


<a id="appendix-a">

<h2>Appendix A: The effect of scaling and mean centering of variables prior to a Principal Component Analysis</h2>
</a><div class="back_to_top"><a id="appendix-a">[</a><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#table-of-contents">back to top</a>]</div>

<p>Let us think about whether it matters or not if the variables are centered for applications such as Principal Component Analysis (PCA) if the PCA is calculated from the covariance matrix (i.e., the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">k</script></span> principal components are the eigenvectors of the covariance matrix that correspond to the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-4" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">k</script></span> largest eigenvalues.</p>



<h3 id="1.meancenteringdoesnotaffectthecovariancematrix">1. Mean centering does not affect the covariance matrix</h3>

<p>Here, the rational is: If the covariance is the same whether the variables are centered or not, the result of the PCA will be the same.</p>

<p>Let’s assume we have the 2 variables <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-7" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-8"><span class="texatom" id="MathJax-Span-9"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\bf{x}</script></span> and <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-12" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-13"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Main-bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.932em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\bf{y}</script></span> Then the covariance between the attributes is calculated as</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-17" role="math" style="width: 16.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-18"><span class="msubsup" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-21"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-26" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-27" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-32" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-45" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-46"><span class="munderover" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-56" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-57"><span class="munderover" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5"> \sigma_{xy} = \frac{1}{n-1} \sum_{i}^{n} (x_i - \bar{x})(y_i - \bar{y})   </script></span></p>

<p>Let us write the centered variables as </p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame"><nobr><span class="math" id="MathJax-Span-62" role="math" style="width: 13.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.979em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-63"><span class="msup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">x</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-70" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-71"><span class="munderover" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-75" style="font-family: MathJax_Main;">&nbsp;and&nbsp;</span><span class="msup" id="MathJax-Span-76"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.539em;"><span class="mo" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-82" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-83"><span class="munderover" id="MathJax-Span-84"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.282em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6"> x' = x - \bar{x} \text{ and } y' = y - \bar{y} </script></span></p>

<p>The centered covariance would then be calculated as follows:</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-87" role="math" style="width: 17.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.586em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-97" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-103" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="msup" id="MathJax-Span-117" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="munderover" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.539em;"><span class="mo" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.479em;"><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="msup" id="MathJax-Span-131" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-132"><span class="mrow" id="MathJax-Span-133"><span class="munderover" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-7"> \sigma_{xy}' = \frac{1}{n-1} \sum_{i}^{n} (x_i' - \bar{x}')(y_i' - \bar{y}')   </script></span></p>

<p>But since after centering, <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-139" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.039em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-140"><span class="msup" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="munderover" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.598em;"><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.075em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\bar{x}' = 0</script></span> and <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-150" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.039em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-151"><span class="msup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="munderover" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.598em;"><span class="mo" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\bar{y}' = 0</script></span> we have </p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-161" role="math" style="width: 10.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.991em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-162"><span class="msubsup" id="MathJax-Span-163"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-166"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-171" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-173"><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-176" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-177" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-185" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-189"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.539em;"><span class="mo" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.479em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-10"> \sigma_{xy}' = \frac{1}{n-1} \sum_{i}^{n} x_i' y_i'   </script></span> which is our original covariance matrix if we resubstitute back the terms
<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-193" role="math" style="width: 13.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.979em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-194"><span class="msup" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">x</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-201" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-202"><span class="munderover" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-206" style="font-family: MathJax_Main;">&nbsp;and&nbsp;</span><span class="msup" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.539em;"><span class="mo" id="MathJax-Span-209" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-213" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-214"><span class="munderover" id="MathJax-Span-215"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.282em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-11"> x' = x - \bar{x} \text{ and } y' = y - \bar{y} </script></span>.</p>

<p>Even centering only one variable, e.g., <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame"><nobr><span class="math" id="MathJax-Span-218" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-219"><span class="texatom" id="MathJax-Span-220"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\bf{x}</script></span> wouldn’t affect the covariance:</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame"><nobr><span class="math" id="MathJax-Span-223" role="math" style="width: 17.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.348em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-224"><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mtext" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Main;">xy</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-231" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-232" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-236" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-237" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-248" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="msup" id="MathJax-Span-251" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="munderover" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-260"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-264" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-265"><span class="munderover" id="MathJax-Span-266"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-13"> \sigma_{\text{xy}} = \frac{1}{n-1} \sum_{i}^{n} (x_i' - \bar{x}')(y_i - \bar{y})   </script></span>
<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-270" role="math" style="width: 14.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.265em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-271"><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-273" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-274" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-278" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-279" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-288"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.241em;">0</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-300" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-301"><span class="munderover" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">  =  \frac{1}{n-1} \sum_{i}^{n} (x_i' - 0)(y_i - \bar{y})   </script></span>
<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame"><nobr><span class="math" id="MathJax-Span-306" role="math" style="width: 14.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-307"><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-309" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-310" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-314" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-315" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-328" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-329"><span class="munderover" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-339" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-340"><span class="munderover" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">  =  \frac{1}{n-1} \sum_{i}^{n} (x_i - \bar{x})(y_i - \bar{y})   </script></span></p>



<h3 id="2.scalingofvariablesdoesaffectthecovariancematrix">2. Scaling of variables does affect the covariance matrix</h3>

<p>If one variable is scaled, e.g, from pounds into kilogram (1 pound = 0.453592 kg), it does affect the covariance and therefore influences the results of a PCA.</p>

<p>Let <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-345" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-346"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.718em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">c</script></span> be the scaling factor for <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-348" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-349"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\bf{x}</script></span></p>

<p>Given that the “original” covariance is calculated as</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame"><nobr><span class="math" id="MathJax-Span-353" role="math" style="width: 16.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-354"><span class="msubsup" id="MathJax-Span-355"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-362" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-363" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-367" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-368" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-370"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-373"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-381" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-382"><span class="munderover" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-388"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-392" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-393"><span class="munderover" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-18"> \sigma_{xy} = \frac{1}{n-1} \sum_{i}^{n} (x_i - \bar{x})(y_i - \bar{y})   </script></span></p>

<p>the covariance after scaling would be calculated as:</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame"><nobr><span class="math" id="MathJax-Span-398" role="math" style="width: 19.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-399"><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-403"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-408" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-414" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main; padding-left: 0.241em;">⋅</span><span class="msubsup" id="MathJax-Span-425" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic; padding-left: 0.241em;">c</span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main; padding-left: 0.241em;">⋅</span><span class="texatom" id="MathJax-Span-431" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-432"><span class="munderover" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-442" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-443"><span class="munderover" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-19"> \sigma_{xy}' = \frac{1}{n-1} \sum_{i}^{n} (c \cdot x_i - c \cdot  \bar{x})(y_i - \bar{y})   </script></span>
<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame"><nobr><span class="math" id="MathJax-Span-448" role="math" style="width: 14.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-449"><span class="mo" id="MathJax-Span-450" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-451" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-456" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-457" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-459"><span class="mrow" id="MathJax-Span-460"><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-466"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-470" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-471"><span class="munderover" id="MathJax-Span-472"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-481" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-482"><span class="munderover" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20"> =  \frac{c}{n-1} \sum_{i}^{n} (x_i -   \bar{x})(y_i - \bar{y})   </script></span></p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame"><nobr><span class="math" id="MathJax-Span-487" role="math" style="width: 7.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.324em 1000.003em 4.884em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">⇒</span><span class="msubsup" id="MathJax-Span-490" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-497" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.467em -999.997em); top: -4.759em; left: 50%; margin-left: -0.711em;"><span class="msubsup" id="MathJax-Span-498"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.235em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 1.551em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.789em; vertical-align: -0.925em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-21"> \Rightarrow \sigma_{xy} = \frac{\sigma_{xy}'}{c} </script></span>
<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22-Frame"><nobr><span class="math" id="MathJax-Span-506" role="math" style="width: 8.039em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.67em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.467em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-507"><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">⇒</span><span class="msubsup" id="MathJax-Span-509" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-512"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">c</span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.241em;">⋅</span><span class="msubsup" id="MathJax-Span-519" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-521"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.425em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-22"> \Rightarrow \sigma_{xy}' = c \cdot \sigma_{xy} </script></span></p>

<p>Therefore, the covariance after scaling one attribute by the constant <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame"><nobr><span class="math" id="MathJax-Span-525" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-526"><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.718em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">c</script></span> will result in a rescaled covariance <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame"><nobr><span class="math" id="MathJax-Span-528" role="math" style="width: 2.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.467em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic;">c</span><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="mi" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">c \sigma_{xy}</script></span> So if we’d scaled <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame"><nobr><span class="math" id="MathJax-Span-537" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-538"><span class="texatom" id="MathJax-Span-539"><span class="mrow" id="MathJax-Span-540"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\bf{x}</script></span> from pounds to kilograms, the covariance between <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame"><nobr><span class="math" id="MathJax-Span-542" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-543"><span class="texatom" id="MathJax-Span-544"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\bf{x}</script></span> and <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame"><nobr><span class="math" id="MathJax-Span-547" role="math" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-548"><span class="texatom" id="MathJax-Span-549"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Main-bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.932em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\bf{y}</script></span> will be 0.453592 times smaller.</p>



<h3 id="3.standardizingaffectsthecovariance">3. Standardizing affects the covariance</h3>

<p>Standardization of features will have an effect on the outcome of a PCA (assuming that the variables are originally not standardized). This is because we are scaling the covariance between every pair of variables by the product of the standard deviations of each pair of variables.</p>

<p>The equation for standardization of a variable is written as </p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame"><nobr><span class="math" id="MathJax-Span-552" role="math" style="width: 5.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.943em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.503em 1000.003em 4.884em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-556" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.348em -999.997em); top: -4.64em; left: 50%; margin-left: -1.366em;"><span class="mrow" id="MathJax-Span-557"><span class="msubsup" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-562" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-563"><span class="munderover" id="MathJax-Span-564"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.295em;"><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.86em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.575em; vertical-align: -0.925em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-28"> z = \frac{x_i - \bar{x}}{\sigma} </script></span></p>

<p>The “original” covariance matrix:</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-29-Frame"><nobr><span class="math" id="MathJax-Span-568" role="math" style="width: 16.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.051em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-569"><span class="msubsup" id="MathJax-Span-570"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-572"><span class="mrow" id="MathJax-Span-573"><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-577" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-578" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-579"><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-582" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-583" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-591" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-592"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-596" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-597"><span class="munderover" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-607" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-608"><span class="munderover" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-29"> \sigma_{xy} = \frac{1}{n-1} \sum_{i}^{n} (x_i - \bar{x})(y_i - \bar{y})   </script></span></p>

<p>And after standardizing both variables:</p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame"><nobr><span class="math" id="MathJax-Span-613" role="math" style="width: 14.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.027em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.503em 1000.003em 5.122em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-614"><span class="msup" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mo" id="MathJax-Span-617" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-619" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-623" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-624"><span class="munderover" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.271em; left: 50%; margin-left: -0.533em;"><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mtext" id="MathJax-Span-631" style="font-family: MathJax_Main;">&nbsp;and&nbsp;</span><span class="msup" id="MathJax-Span-632"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.539em;"><span class="mo" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-636" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-640" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-641"><span class="munderover" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.467em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="msubsup" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.443em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.932em; vertical-align: -1.211em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-30"> x' = \frac{x - \bar{x}}{\sigma_x} \text{ and } y' =\frac{y - \bar{y}}{\sigma_y} </script></span></p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame"><nobr><span class="math" id="MathJax-Span-648" role="math" style="width: 16.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.932em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-649"><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-658" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-659" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-660"><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-663" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-664" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-666"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-669"><span class="mrow" id="MathJax-Span-670"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.598em;"><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-677" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-678" style="font-family: MathJax_Main; padding-left: 0.241em;">0</span><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-681"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.539em;"><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.17em -999.997em); top: -3.688em; left: 0.479em;"><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.241em;">0</span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-31"> \sigma_{xy}' =  \frac{1}{n-1} \sum_{i}^{n} (x_i' - 0)(y_i' - 0)   </script></span></p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame"><nobr><span class="math" id="MathJax-Span-688" role="math" style="width: 16.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.991em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-689"><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-691" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-692" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-693"><span class="mi" id="MathJax-Span-694" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-696" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-697" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-699"><span class="mrow" id="MathJax-Span-700"><span class="mi" id="MathJax-Span-701" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="texatom" id="MathJax-Span-705" style="padding-left: 0.182em;"><span class="mrow" id="MathJax-Span-706"><span class="mo" id="MathJax-Span-707" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span><span class="mfrac" id="MathJax-Span-708"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-709"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-712" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-713"><span class="munderover" id="MathJax-Span-714"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.271em; left: 50%; margin-left: -0.533em;"><span class="msubsup" id="MathJax-Span-717"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-718" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.503em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="texatom" id="MathJax-Span-720" style=""><span class="mrow" id="MathJax-Span-721"><span class="mo" id="MathJax-Span-722" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span class="texatom" id="MathJax-Span-723" style=""><span class="mrow" id="MathJax-Span-724"><span class="mo" id="MathJax-Span-725" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span><span class="mfrac" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-727"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-730" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-731"><span class="munderover" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.467em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="msubsup" id="MathJax-Span-735"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.443em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="texatom" id="MathJax-Span-738" style=""><span class="mrow" id="MathJax-Span-739"><span class="mo" id="MathJax-Span-740" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">  =  \frac{1}{n-1} \sum_{i}^{n} \bigg(\frac{x - \bar{x}}{\sigma_x}\bigg)\bigg(\frac{y - \bar{y}}{\sigma_y}\bigg)   </script></span></p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-33-Frame"><nobr><span class="math" id="MathJax-Span-741" role="math" style="width: 19.17em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.265em 1000.003em 5.36em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-742"><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-744" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 6.074em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.003em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-745" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.003em 4.467em -999.997em); top: -3.271em; left: 50%; margin-left: -2.973em;"><span class="mrow" id="MathJax-Span-746"><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="mn" id="MathJax-Span-750" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.241em;">⋅</span><span class="msubsup" id="MathJax-Span-753" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-756"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 6.074em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-759" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1000.003em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-760" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.003em 4.289em -999.997em); top: -2.914em; left: 0.598em;"><span class="texatom" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -5.116em; left: 0.539em;"><span class="texatom" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="mi" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-768"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-772" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-773"><span class="munderover" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-777" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-779"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-782" style="font-family: MathJax_Main; padding-left: 0.241em;">−</span><span class="texatom" id="MathJax-Span-783" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-784"><span class="munderover" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em 1000.003em 3.634em -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-788" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.432em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">   = \frac{1}{(n-1) \cdot \sigma_x \sigma_y} \sum_{i}^{n} (x_i - \bar{x})(y_i - \bar{y})   </script></span></p>

<p><span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame"><nobr><span class="math" id="MathJax-Span-789" role="math" style="width: 7.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.622em 1000.003em 5.122em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-790"><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">⇒</span><span class="msubsup" id="MathJax-Span-792" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.11em -999.997em); top: -4.283em; left: 0.598em;"><span class="mo" id="MathJax-Span-794" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.003em 4.289em -999.997em); top: -3.866em; left: 0.598em;"><span class="texatom" id="MathJax-Span-795"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-800" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.146em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.467em -999.997em); top: -4.759em; left: 50%; margin-left: -0.711em;"><span class="msubsup" id="MathJax-Span-801"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="mi" id="MathJax-Span-805" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.003em 4.467em -999.997em); top: -3.271em; left: 50%; margin-left: -1.009em;"><span class="mrow" id="MathJax-Span-807"><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-811"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.003em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="border-left-width: 2.146em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.789em; vertical-align: -1.211em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34"> \Rightarrow \sigma_{xy}' = \frac{\sigma_{xy}}{\sigma_x \sigma_y} </script></span></p>




<a id="appendix-b">
<h1>Appendix B: PCA based on the covariance matrix vs. correlation matrix</h1>
</a><div class="back_to_top"><a id="appendix-b">[</a><a href="http://sebastianraschka.com/Articles/2014_pca_step_by_step.html#Sections">back to top</a>]</div>

<p>The purpose of this section is to show that a Principal Component Analysis based on the covariance matrix of the standardized data yields similar results to an PCA using the correlation matrix (the correlation matrix can be defined as the standardized covariance matrix). </p>

<p>A common application of PCA is to reduce the dimensions of the dataset with minimal loss of information where the entire dataset (<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame"><nobr><span class="math" id="MathJax-Span-814" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-815"><span class="mi" id="MathJax-Span-816" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">d</script></span> dimensions) is projected onto a new subspace (<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame"><nobr><span class="math" id="MathJax-Span-817" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">k</script></span> dimensions where <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame"><nobr><span class="math" id="MathJax-Span-820" role="math" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.229em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-821"><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main; padding-left: 0.301em;">&lt;</span><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.139em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">k < d</script></span>).
This method of projection is useful in order to reduce the computational costs and the error of parameter estimation (“curse of dimensionality”). The standard PCA approach can be summarized in six simple steps:</p>

<ol>
<li>Compute the covariance matrix of the original or standardized <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame"><nobr><span class="math" id="MathJax-Span-825" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-826"><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">d</script></span>-dimensional dataset <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame"><nobr><span class="math" id="MathJax-Span-828" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-829"><span class="texatom" id="MathJax-Span-830"><span class="mrow" id="MathJax-Span-831"><span class="mtext" id="MathJax-Span-832" style="font-family: MathJax_Main-bold;">X</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">\textbf{X}</script></span> (here: <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame"><nobr><span class="math" id="MathJax-Span-833" role="math" style="width: 2.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-837" style="font-family: MathJax_Main; padding-left: 0.301em;">3</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">d = 3</script></span>); alternatively, compute the correlation matrix.</li>
<li>Eigendecomposition: Compute the eigenvectors and eigenvalues of the covariance matrix (or correlation matrix).</li>
<li>Sort the eigenvalues in descending order.</li>
<li>Choose the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame"><nobr><span class="math" id="MathJax-Span-838" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">k</script></span> eigenvectors that correspond to the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame"><nobr><span class="math" id="MathJax-Span-841" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">k</script></span> largest eigenvalues where <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame"><nobr><span class="math" id="MathJax-Span-844" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-845"><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">k</script></span> is the number of dimensions of the new feature subspace (<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame"><nobr><span class="math" id="MathJax-Span-847" role="math" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.289em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-848"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main; padding-left: 0.301em;">≤</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.146em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">k \le d</script></span>).</li>
<li>Construct the projection matrix <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame"><nobr><span class="math" id="MathJax-Span-852" role="math" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-853"><span class="texatom" id="MathJax-Span-854"><span class="mrow" id="MathJax-Span-855"><span class="mtext" id="MathJax-Span-856" style="font-family: MathJax_Main-bold;">W</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">\textbf{W}</script></span> from the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame"><nobr><span class="math" id="MathJax-Span-857" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-858"><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">k</script></span> selected eigenvectors.</li>
<li>Transform the original dataset <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame"><nobr><span class="math" id="MathJax-Span-860" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-861"><span class="texatom" id="MathJax-Span-862"><span class="mrow" id="MathJax-Span-863"><span class="mtext" id="MathJax-Span-864" style="font-family: MathJax_Main-bold;">X</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">\textbf{X}</script></span> to obtain the <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-865" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-866"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">k</script></span> dimensional feature subspace <span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame"><nobr><span class="math" id="MathJax-Span-868" role="math" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-869"><span class="texatom" id="MathJax-Span-870"><span class="mrow" id="MathJax-Span-871"><span class="mtext" id="MathJax-Span-872" style="font-family: MathJax_Main-bold;">Y</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">\textbf{Y}</script></span> (<span class="math"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame"><nobr><span class="math" id="MathJax-Span-873" role="math" style="width: 6.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.92em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mrow" id="MathJax-Span-874"><span class="texatom" id="MathJax-Span-875"><span class="mrow" id="MathJax-Span-876"><span class="mtext" id="MathJax-Span-877" style="font-family: MathJax_Main-bold;">Y</span></span></span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-879" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.003em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-880"><span class="mrow" id="MathJax-Span-881"><span class="mtext" id="MathJax-Span-882" style="font-family: MathJax_Main-bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.193em;"><span class="mi" id="MathJax-Span-883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main; padding-left: 0.241em;">⋅</span><span class="texatom" id="MathJax-Span-885" style="padding-left: 0.241em;"><span class="mrow" id="MathJax-Span-886"><span class="mtext" id="MathJax-Span-887" style="font-family: MathJax_Main-bold;">X</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">\textbf{Y} = \textbf{W}^T \cdot \textbf{X}</script></span>).</li>
</ol>

<p><strong>Whether to standardize the data prior to a PCA on the covariance matrix (or correlation matrix) depends on the measurement scales of the original features. Since PCA yields a feature subspace that maximizes the variance along the axes, it makes sense to standardize the data if it was measured on different scales.</strong></p>
<h3>Dataset</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Iris_flower_data_set">Iris flower dataset</a> will be used for this example. The dataset consists of 150 samples with 4 different features that have all been measured in the unit centimeter. For demonstration purposes, the first feature will be converted to inches and the second feature to meters, respectively.</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>

<span class="c"># convert features in column 1 from cm to inches</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">2.54</span>
<span class="c"># convert features in column 2 from cm to meters</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">100</span>
</pre></div>


<h3>PCA Based on the Covariance Matrix of the Raw Data</h3>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">pca_raw_cov</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="c"># Compute the covariance matrix</span>
    <span class="n">cov_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="c"># Eigendecomposition of the covariance matrix</span>
    <span class="n">eig_val_cov</span><span class="p">,</span> <span class="n">eig_vec_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov_mat</span><span class="p">)</span>

    <span class="c"># Make a list of (eigenvalue, eigenvector) tuples</span>
    <span class="c"># and sort the (eigenvalue, eigenvector) tuples from high to low</span>
    <span class="n">eig_pairs_cov</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eig_val_cov</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">eig_vec_cov</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eig_val_cov</span><span class="p">))]</span>
    <span class="n">eig_pairs_cov</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">eig_pairs_cov</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="c"># Construct the transformation matrix W from the eigenvalues that correspond to</span>
    <span class="c"># the k largest eigenvalues (here: k = 2)</span>
    <span class="n">matrix_w_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">eig_pairs_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">eig_pairs_cov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c"># Transform the data using matrix W</span>
    <span class="n">X_raw_transf</span> <span class="o">=</span> <span class="n">matrix_w_cov</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_raw_transf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_raw_transf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'PCA based on the covariance matrix of the raw data'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h3>PCA Based on the Covariance Matrix of the Standardized Data</h3>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">pca_standardize_cov</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>

    <span class="c"># Standardize data</span>
    <span class="n">X_std</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c"># Compute the covariance matrix</span>
    <span class="n">cov_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X_std</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="c"># Eigendecomposition of the covariance matrix</span>
    <span class="n">eig_val_cov</span><span class="p">,</span> <span class="n">eig_vec_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov_mat</span><span class="p">)</span>

    <span class="c"># Make a list of (eigenvalue, eigenvector) tuples</span>
    <span class="c"># and sort the (eigenvalue, eigenvector) tuples from high to low</span>
    <span class="n">eig_pairs_cov</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eig_val_cov</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">eig_vec_cov</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eig_val_cov</span><span class="p">))]</span>
    <span class="n">eig_pairs_cov</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">eig_pairs_cov</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="c"># Construct the transformation matrix W from the eigenvalues that correspond to</span>
    <span class="c"># the k largest eigenvalues (here: k = 2)</span>
    <span class="n">matrix_w_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">eig_pairs_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">eig_pairs_cov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c"># Transform the data using matrix W</span>
    <span class="n">X_std_transf</span> <span class="o">=</span> <span class="n">matrix_w_cov</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_std</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_std_transf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_std_transf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'PCA based on the covariance matrix after standardizing the data'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h3>PCA Based on the Correlation Matrix</h3>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">pca_cor</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>

    <span class="c"># Standardize data</span>
    <span class="n">X_std</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c"># Compute the correlation matrix</span>
    <span class="n">cor_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="c"># Eigendecomposition of the correlation matrix</span>
    <span class="n">eig_val_cor</span><span class="p">,</span> <span class="n">eig_vec_cor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cor_mat</span><span class="p">)</span>

    <span class="c"># Make a list of (eigenvalue, eigenvector) tuples</span>
    <span class="c"># and sort the (eigenvalue, eigenvector) tuples from high to low</span>
    <span class="n">eig_pairs_cor</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eig_val_cor</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">eig_vec_cor</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eig_val_cor</span><span class="p">))]</span>
    <span class="n">eig_pairs_cor</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">eig_pairs_cor</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="c"># Construct the transformation matrix W from the eigenvalues that correspond to</span>
    <span class="c"># the k largest eigenvalues (here: k = 2)</span>
    <span class="n">matrix_w_cor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">eig_pairs_cor</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">eig_pairs_cor</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c"># Transform the data using matrix W</span>
    <span class="n">X_transf</span> <span class="o">=</span> <span class="n">matrix_w_cor</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_std</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_transf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_transf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'PCA based on the correlation matrix of the raw data'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h3>PCA Using scikit-learn (based on SVD)</h3>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="k">def</span> <span class="nf">scikit_pca</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>

    <span class="c"># Standardize</span>
    <span class="n">X_std</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c"># PCA</span>
    <span class="n">sklearn_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">X_transf</span> <span class="o">=</span> <span class="n">sklearn_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_std</span><span class="p">)</span>

    <span class="c"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_transf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_transf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'PCA via scikit-learn (using SVD)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h3>Results</h3>
<div class="codehilite"><pre><span class="n">pca_raw_cov</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">pca_standardize_cov</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">pca_cor</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<p><img alt="" src="./Principal Component Analysis step by step_files/appendix_b_1.png">
<img alt="" src="./Principal Component Analysis step by step_files/appendix_b_2.png">
<img alt="" src="./Principal Component Analysis step by step_files/appendix_b_3.png"></p>
<img alt="" src="./Principal Component Analysis step by step_files/appendix_b_4.png"><p></p>
<p>The plot of the transformed data shows that PCA based on the correlation matrix produces similar results to a PCA based on the covariance matrix of the standardized data.</p>



		</div> 	<!-- close article -->
</article>


<!-- START Footer -->
	<div id="footer">
        <hr>
        © 2013-present Sebastian Raschka |<a href="https://twitter.com/rasbt">@rasbt</a> <a href="mailto:se.raschka@gmail.com">email</a> <a href="http://sebastianraschka.com/rss_feed.xml">rss</a>
	    <hr>
    </div>
<!-- END Footer -->

<!-- Start Google Analytics -->
	<script type="text/javascript">

  		var _gaq = _gaq || [];
  		_gaq.push(['_setAccount', 'UA-38457794-1']);
  		_gaq.push(['_trackPageview']);

  		(function() {
    	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  		})();
	</script>
<!-- End  Google Analytics -->

<!-- START DISQUS -->

 <div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Principal Component Analysis step by step_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 8869px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="dsq-indicator-north" data-disqus-uid="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 650px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 650px !important; max-width: 650px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe><iframe id="dsq-indicator-south" data-disqus-uid="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 650px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 650px !important; max-width: 650px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sebastianraschka'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>
    

<!-- END DISQUS -->



<div class="extLives"></div><iframe name="oauth2relay348630288" id="oauth2relay348630288" src="./Principal Component Analysis step by step_files/postmessageRelay.html" tabindex="-1" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe><div id="feedly-mini" title="feedly Mini tookit"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>